{"remainingRequest":"/Users/apple/Desktop/git/vue_cli_try/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/apple/Desktop/git/vue_cli_try/src/views/dashboard/Products.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/apple/Desktop/git/vue_cli_try/src/views/dashboard/Products.vue","mtime":1596555748117},{"path":"/Users/apple/Desktop/git/vue_cli_try/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/apple/Desktop/git/vue_cli_try/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/apple/Desktop/git/vue_cli_try/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/apple/Desktop/git/vue_cli_try/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCAkIGZyb20gJ2pxdWVyeScKaW1wb3J0IHByb2R1Y3RNb2RhbCBmcm9tICcuL1Byb2R1Y3RNb2RhbCcKaW1wb3J0IGRlbFByb2R1Y3RNb2RhbCBmcm9tICcuL0RlbFByb2R1Y3RNb2RhbCcKaW1wb3J0IHBhZ2luYXRpb24gZnJvbSAnLi4vLi9QYWdpbmF0aW9uJwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ1Byb2R1Y3RzJywKICBwcm9wczogWyd0b2tlbiddLAogIGRhdGEgKCkgewogICAgcmV0dXJuIHsKICAgICAgcHJvZHVjdHM6IFtdLAogICAgICBwYWdpbmF0aW9uOiB7fSwKICAgICAgaXNMb2FkaW5nOiBmYWxzZSwKICAgICAgdGVtcFByb2R1Y3Q6IHsKICAgICAgICBpbWFnZVVybDogW10sCiAgICAgICAgZW5hYmxlZDogZmFsc2UKICAgICAgfSwKICAgICAgaXNOZXc6IGZhbHNlCiAgICB9CiAgfSwKICBjb21wb25lbnRzOiB7CiAgICBwcm9kdWN0TW9kYWwsCiAgICBkZWxQcm9kdWN0TW9kYWwsCiAgICBwYWdpbmF0aW9uCiAgfSwKICBjcmVhdGVkICgpIHsKICAgIHRoaXMuZ2V0UHJvZHVjdHMoKQogICAgdGhpcy4kYnVzLiRvbigncHJvZHVjdFVwZGF0ZScsIGV2ZW50ID0+IHsKICAgICAgY29uc3QgcHJvZHVjdHNJZCA9IHRoaXMucHJvZHVjdHMubWFwKHByb2R1Y3QgPT4gcHJvZHVjdC5pZCkKICAgICAgY29uc29sZS5sb2cocHJvZHVjdHNJZCkKICAgICAgaWYgKHByb2R1Y3RzSWQuaW5jbHVkZXMoZXZlbnQucHJvZHVjdC5pZCkpIHsKICAgICAgICB0aGlzLnByb2R1Y3RzLmZvckVhY2goKGVsLCBpZHgpID0+IHsKICAgICAgICAgIGlmIChlbC5pZCA9PT0gZXZlbnQucHJvZHVjdC5pZCkgewogICAgICAgICAgICB0aGlzLnByb2R1Y3RzW2lkeF0gPSBldmVudC5wcm9kdWN0CiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmdldFByb2R1Y3RzKCkKICAgICAgfQogICAgfSkKICB9LAogIG1ldGhvZHM6IHsKICAgIGdldFByb2R1Y3RzIChwYWdlID0gMSkgewogICAgICB0aGlzLmlzTG9hZGluZyA9IHRydWUKICAgICAgY29uc3QgYXBpID0gYCR7cHJvY2Vzcy5lbnYuVlVFX0FQUF9BUElQQVRIfWFwaS8ke3Byb2Nlc3MuZW52LlZVRV9BUFBfVVVJRH0vYWRtaW4vZWMvcHJvZHVjdHM/cGFnZT0ke3BhZ2V9YAogICAgICB0aGlzLiRodHRwLmdldChhcGkpLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgdGhpcy5wcm9kdWN0cyA9IHJlc3BvbnNlLmRhdGEuZGF0YQogICAgICAgIHRoaXMucGFnaW5hdGlvbiA9IHJlc3BvbnNlLmRhdGEubWV0YS5wYWdpbmF0aW9uCiAgICAgICAgdGhpcy5pc0xvYWRpbmcgPSBmYWxzZQogICAgICB9KQogICAgfSwKICAgIG9wZW5Nb2RhbCAoaXNOZXcsIGl0ZW0pIHsKICAgICAgc3dpdGNoIChpc05ldykgewogICAgICAgIGNhc2UgJ25ldyc6CiAgICAgICAgICB0aGlzLmlzTmV3ID0gdHJ1ZQogICAgICAgICAgdGhpcy4kcmVmcy5wcm9kdWN0TW9kZWwuY2xlYXJUZW1wUHJvZHVjdCgpCiAgICAgICAgICAkKCcjcHJvZHVjdE1vZGFsJykubW9kYWwoJ3Nob3cnKQogICAgICAgICAgYnJlYWsKICAgICAgICBjYXNlICdlZGl0JzoKICAgICAgICAgIHRoaXMudGVtcFByb2R1Y3QgPSBPYmplY3QuYXNzaWduKHt9LCBpdGVtKQogICAgICAgICAgdGhpcy5pc05ldyA9IGZhbHNlCiAgICAgICAgICB0aGlzLiRyZWZzLnByb2R1Y3RNb2RlbC5nZXRQcm9kdWN0KHRoaXMudGVtcFByb2R1Y3QuaWQpCiAgICAgICAgICBicmVhawogICAgICAgIGNhc2UgJ2RlbGV0ZSc6CiAgICAgICAgICAkKCcjZGVsUHJvZHVjdE1vZGFsJykubW9kYWwoJ3Nob3cnKQogICAgICAgICAgdGhpcy50ZW1wUHJvZHVjdCA9IE9iamVjdC5hc3NpZ24oe30sIGl0ZW0pCiAgICAgICAgICBicmVhawogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICBicmVhawogICAgICB9CiAgICB9LAogICAgc3dpdGNoVG9BY3RpdmUgKGl0ZW0pIHsKICAgICAgdGhpcy50ZW1wUHJvZHVjdCA9IE9iamVjdC5hc3NpZ24oe30sIGl0ZW0pCiAgICAgIHRoaXMudGVtcFByb2R1Y3QuZW5hYmxlZCA9ICF0aGlzLnRlbXBQcm9kdWN0LmVuYWJsZWQKICAgICAgdGhpcy5pc05ldyA9IGZhbHNlCiAgICAgIHRoaXMuJHJlZnMucHJvZHVjdE1vZGVsLnVwZGF0ZVByb2R1Y3QodGhpcy50ZW1wUHJvZHVjdCkKICAgIH0sCiAgICB0b29sVGlwICgpIHsKICAgICAgJCgnW2RhdGEtdG9nZ2xlPSJ0b29sdGlwIl0nKS50b29sdGlwKCkKICAgIH0sCiAgICBsb2FkaW5nU3dpdGNoICgpIHsKICAgICAgdGhpcy5pc0xvYWRpbmcgPSAhdGhpcy5pc0xvYWRpbmcKICAgIH0KICB9Cn0K"},{"version":3,"sources":["Products.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Products.vue","sourceRoot":"src/views/dashboard","sourcesContent":["<template>\n  <div class=\"backend-products\" ref=\"backend-products\">\n    <loading :active.sync=\"isLoading\"></loading>\n    <div class=\"above-table text-right mt-4\">\n      <button class=\"btn create-product\" @click=\"openModal('new')\">\n        ＋ ADD ITEM\n      </button>\n    </div>\n    <div class=\"table-wrapper\">\n      <table class=\"table mt-4\">\n        <thead class=\"thead-dark\">\n          <tr>\n            <th></th>\n            <th>分類</th>\n            <th>產品名稱</th>\n            <th>原價</th>\n            <th>售價</th>\n            <th>啟用</th>\n            <th></th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr v-for=\"item in products\" :key=\"item.id\">\n            <td class=\"td-img\">\n              <div class=\"img-wrapper mx-auto my-auto\">\n                <img :src=\"item.imageUrl\" class=\"product-image\">\n              </div>\n            </td>\n            <td>{{ item.category }}</td>\n            <td>{{ item.title }}</td>\n            <td>{{ item.origin_price }}</td>\n            <td>{{ item.price }}</td>\n            <td>\n              <div class=\"onoffswitch mx-auto align-middle\">\n                <input type=\"checkbox\"  @click=\"switchToActive(item)\" name=\"onoffswitch\" class=\"onoffswitch-checkbox\" :class=\"{ checked: item.enabled}\" :id=\"`switch-${item.id}`\" tabindex=\"0\" checked>\n                <label class=\"onoffswitch-label\" :for=\"`switch-${item.id}`\"></label>\n              </div>\n            </td>\n            <td>\n              <button class=\"btn btn-sm\" @click=\"openModal('edit', item)\" @mouseover=\"toolTip\" data-toggle=\"tooltip\" title=\"編輯產品\">\n                  <i class=\"fa fa-edit fa-lg\"></i>\n              </button>\n              <button class=\"btn btn-sm\" @click=\"openModal('delete', item)\" @mouseover=\"toolTip\" data-toggle=\"tooltip\" title=\"刪除產品\">\n                  <i class=\"fa fa-trash fa-lg\"></i>\n              </button>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n    <pagination :pages=\"pagination\" @emit-pages=\"getProducts\" class=\"pagination-wrapper\"></pagination>\n    <product-modal ref=\"productModel\" :is-new=\"isNew\" :token=\"token\" @loading=\"loadingSwitch\"></product-modal>\n    <del-product-modal :temp-product=\"tempProduct\" @update=\"getProducts\" :token=\"token\"></del-product-modal>\n  </div>\n</template>\n\n<script>\nimport $ from 'jquery'\nimport productModal from './ProductModal'\nimport delProductModal from './DelProductModal'\nimport pagination from '.././Pagination'\nexport default {\n  name: 'Products',\n  props: ['token'],\n  data () {\n    return {\n      products: [],\n      pagination: {},\n      isLoading: false,\n      tempProduct: {\n        imageUrl: [],\n        enabled: false\n      },\n      isNew: false\n    }\n  },\n  components: {\n    productModal,\n    delProductModal,\n    pagination\n  },\n  created () {\n    this.getProducts()\n    this.$bus.$on('productUpdate', event => {\n      const productsId = this.products.map(product => product.id)\n      console.log(productsId)\n      if (productsId.includes(event.product.id)) {\n        this.products.forEach((el, idx) => {\n          if (el.id === event.product.id) {\n            this.products[idx] = event.product\n          }\n        })\n      } else {\n        this.getProducts()\n      }\n    })\n  },\n  methods: {\n    getProducts (page = 1) {\n      this.isLoading = true\n      const api = `${process.env.VUE_APP_APIPATH}api/${process.env.VUE_APP_UUID}/admin/ec/products?page=${page}`\n      this.$http.get(api).then((response) => {\n        this.products = response.data.data\n        this.pagination = response.data.meta.pagination\n        this.isLoading = false\n      })\n    },\n    openModal (isNew, item) {\n      switch (isNew) {\n        case 'new':\n          this.isNew = true\n          this.$refs.productModel.clearTempProduct()\n          $('#productModal').modal('show')\n          break\n        case 'edit':\n          this.tempProduct = Object.assign({}, item)\n          this.isNew = false\n          this.$refs.productModel.getProduct(this.tempProduct.id)\n          break\n        case 'delete':\n          $('#delProductModal').modal('show')\n          this.tempProduct = Object.assign({}, item)\n          break\n        default:\n          break\n      }\n    },\n    switchToActive (item) {\n      this.tempProduct = Object.assign({}, item)\n      this.tempProduct.enabled = !this.tempProduct.enabled\n      this.isNew = false\n      this.$refs.productModel.updateProduct(this.tempProduct)\n    },\n    toolTip () {\n      $('[data-toggle=\"tooltip\"]').tooltip()\n    },\n    loadingSwitch () {\n      this.isLoading = !this.isLoading\n    }\n  }\n}\n</script>\n<style lang=\"scss\">\n.backend-products {\n  margin: auto;\n  max-width: 1140px;\n  width: 100%;\n  height: 100%;\n  .above-table {\n    .btn {\n      border-radius: 10px;\n    }\n    .create-product {\n      background: #63c76a;\n      color: #FFFFFF;\n      border-radius: 0px;\n      transition: background-color 0.3s, box-shadow 0.3s;\n    }\n    .create-product:hover {\n      color: #FFFFFF;\n      background: #49E845;\n    }\n  }\n  .table-wrapper {\n    border-radius: 10px;\n    -webkit-box-shadow: 0px 2px 5px 0px rgba(0, 0, 0, 0.3);\n    -moz-box-shadow: 0px 2px 5px 0px rgba(0, 0, 0, 0.3);\n    box-shadow: 0px 2px 5px 0px rgba(0, 0, 0, 0.3);\n    .table {\n      max-width: 100%;\n      width: 100%;\n      border-radius: 10px;\n      overflow: hidden;\n      background-color: #FFFFFF;\n      thead {\n        th {\n          text-align: center;\n          vertical-align: middle;\n        }\n      }\n      tbody {\n        tr {\n          td {\n            text-align: center;\n            vertical-align: middle;\n            .td-img {\n              max-width: 300px;\n            }\n            .onoffswitch {\n              position: relative; width: 60px;\n              -webkit-user-select:none; -moz-user-select:none; -ms-user-select: none;\n              .onoffswitch-checkbox {\n                position: absolute;\n                opacity: 0;\n                pointer-events: none;\n              }\n              .onoffswitch-label {\n                display: block; overflow: hidden; cursor: pointer;\n                height: 36px; padding: 0; margin: 0px; line-height: 36px;\n                border: 2px solid #E3E3E3; border-radius: 36px;\n                background-color: #E3E3E3;\n                transition: background-color 0.3s ease-in;\n              }\n              .onoffswitch-label:before {\n                content: \"\";\n                display: block; width: 36px; margin: 0px;\n                background: #FFFFFF;\n                position: absolute; top: 0; bottom: 0;\n                right: 22px;\n                border: 2px solid #E3E3E3; border-radius: 36px;\n                transition: all 0.3s ease-in 0s;\n              }\n              .onoffswitch-checkbox.checked + .onoffswitch-label {\n                background-color: #49E845;\n              }\n              .onoffswitch-checkbox.checked + .onoffswitch-label,\n              .onoffswitch-checkbox.checked + .onoffswitch-label:before {\n                border-color: #49E845;\n              }\n              .onoffswitch-checkbox.checked + .onoffswitch-label:before {\n                right: 0px;\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n.modal-content {\n    border-radius: 10px;\n}\n\n.img-wrapper {\n    padding: 10px;\n    width: 200px;\n    height: 100px;\n}\n.modal-img-wrapper {\n    padding: 10px;\n    width: 300px;\n    height: 180px;\n    max-width: 100%;\n    max-height: 100%;\n}\n.product-image {\n    max-width: 100%;\n    max-height: 100%;\n    border-radius: 10px;\n}\n.validation {\n    font-size: 10px;\n}\n.fa-times-circle {\n    cursor: pointer;\n}\n</style>\n"]}]}