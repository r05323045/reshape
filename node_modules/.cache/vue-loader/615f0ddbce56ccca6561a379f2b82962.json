{"remainingRequest":"/Users/apple/Desktop/git/vue_cli_try/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/apple/Desktop/git/vue_cli_try/src/views/Product.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/apple/Desktop/git/vue_cli_try/src/views/Product.vue","mtime":1596555971759},{"path":"/Users/apple/Desktop/git/vue_cli_try/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/apple/Desktop/git/vue_cli_try/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/apple/Desktop/git/vue_cli_try/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/apple/Desktop/git/vue_cli_try/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnUHJvZHVjdCcsCiAgZGF0YSAoKSB7CiAgICByZXR1cm4gewogICAgICBwcm9kdWN0OiB7fSwKICAgICAgY2FydDoge30sCiAgICAgIGNhcnRQYXRjaDogewogICAgICAgIHByb2R1Y3Q6IFN0cmluZywKICAgICAgICBxdWFudGl0eTogMQogICAgICB9LAogICAgICBjYXJ0UXVhbnRpdHk6IDEsCiAgICAgIGFscmVhZHlQdXQ6IGZhbHNlLAogICAgICByYW5kb21SYXRpbmc6IHsKICAgICAgICByYXRlOiBbXSwKICAgICAgICBjb3VudDogTnVtYmVyCiAgICAgIH0KICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICBjYXJ0SWQ6IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKHRoaXMuY2FydC5sZW5ndGggPiAwKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuY2FydC5tYXAoaXRlbSA9PiBpdGVtLnByb2R1Y3QuaWQpCiAgICAgIH0KICAgICAgcmV0dXJuIFtdCiAgICB9CiAgfSwKICB3YXRjaDogewogICAgY2FydFF1YW50aXR5OiBmdW5jdGlvbiAobmV3VmFsdWUsIG9sZFZhbHVlKSB7CiAgICAgIGxldCBudW0gPSBuZXdWYWx1ZQogICAgICBpZiAoIS9eWzAtOV0rJC8udGVzdChudW0pIHx8IG51bSA8IDEpIHsKICAgICAgICBudW0gPSBvbGRWYWx1ZQogICAgICAgIHRoaXMuY2FydFF1YW50aXR5ID0gb2xkVmFsdWUKICAgICAgfQogICAgICB0aGlzLmNhcnRQYXRjaC5xdWFudGl0eSA9IG51bQogICAgfQogIH0sCiAgY3JlYXRlZCAoKSB7CiAgICBjb25zdCBsb2FkZXIgPSB0aGlzLiRsb2FkaW5nLnNob3coewogICAgICBjb250YWluZXI6IHRoaXMuJHJlZnMucHJvZHVjdCwKICAgICAgb3BhY2l0eTogMSwKICAgICAgaXNGdWxsUGFnZTogdHJ1ZQogICAgfSkKICAgIGNvbnN0IHsgaWQgfSA9IHRoaXMuJHJvdXRlLnBhcmFtcwogICAgdGhpcy5jYXJ0UGF0Y2gucHJvZHVjdCA9IGlkCiAgICBjb25zdCB1cmwgPSBgJHtwcm9jZXNzLmVudi5WVUVfQVBQX0FQSVBBVEh9YXBpLyR7cHJvY2Vzcy5lbnYuVlVFX0FQUF9VVUlEfS9lYy9wcm9kdWN0LyR7aWR9YAogICAgdGhpcy4kaHR0cC5nZXQodXJsKQogICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgdGhpcy5wcm9kdWN0ID0gcmVzLmRhdGEuZGF0YQogICAgICAgIHRoaXMuZ2V0Q2FydChsb2FkZXIpCiAgICAgIH0pCiAgICB0aGlzLnJhbmRvbVJhdGluZy5yYXRlID0gdGhpcy5yYXRpbmcoKQogICAgdGhpcy5yYW5kb21SYXRpbmcuY291bnQgPSBNYXRoLmZsb29yKCg1MCArIE1hdGgucmFuZG9tKCkgKiA1MDApKQogIH0sCiAgbWV0aG9kczogewogICAgcmF0aW5nICgpIHsKICAgICAgY29uc3QgcmVzdWx0ID0gW10KICAgICAgY29uc3Qgc2NvcmUgPSBNYXRoLmZsb29yKCgyLjUgKyBNYXRoLnJhbmRvbSgpICogMikgKiAyLjUpIC8gMgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IE1hdGguZmxvb3Ioc2NvcmUpOyBpKyspIHsKICAgICAgICByZXN1bHQucHVzaCgnb24nKQogICAgICB9CiAgICAgIGlmIChzY29yZSAlIDEgIT09IDApIHsKICAgICAgICByZXN1bHQucHVzaCgnaGFsZicpCiAgICAgIH0KICAgICAgd2hpbGUgKHJlc3VsdC5sZW5ndGggPCA1KSB7CiAgICAgICAgcmVzdWx0LnB1c2goJ29mZicpCiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3VsdAogICAgfSwKICAgIGFkZFRvQ2FydCAoKSB7CiAgICAgIGNvbnN0IGxvYWRlciA9IHRoaXMuJGxvYWRpbmcuc2hvdyh7CiAgICAgICAgY29udGFpbmVyOiB0aGlzLiRyZWZzLnByb2R1Y3QsCiAgICAgICAgb3BhY2l0eTogMC44CiAgICAgIH0pCiAgICAgIGNvbnN0IHVybCA9IGAke3Byb2Nlc3MuZW52LlZVRV9BUFBfQVBJUEFUSH1hcGkvJHtwcm9jZXNzLmVudi5WVUVfQVBQX1VVSUR9L2VjL3Nob3BwaW5nYAogICAgICBsZXQgbWV0aG9kID0gJ3Bvc3QnCiAgICAgIGNvbnN0IGluZGV4T2ZQYXRjaCA9IHRoaXMuY2FydElkLmluZGV4T2YodGhpcy5jYXJ0UGF0Y2gucHJvZHVjdCkKICAgICAgaWYgKGluZGV4T2ZQYXRjaCA+PSAwKSB7CiAgICAgICAgbWV0aG9kID0gJ3BhdGNoJwogICAgICAgIGlmICh0aGlzLmNhcnRbaW5kZXhPZlBhdGNoXS5xdWFudGl0eSA9PT0gTnVtYmVyKHRoaXMuY2FydFBhdGNoLnF1YW50aXR5KSkgewogICAgICAgICAgbWV0aG9kID0gJ25vbmUnCiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsgbG9hZGVyLmhpZGUoKSB9LCAxMDAwKQogICAgICAgIH0KICAgICAgfQogICAgICBpZiAobWV0aG9kICE9PSAnbm9uZScpIHsKICAgICAgICB0aGlzLiRodHRwW21ldGhvZF0odXJsLCB0aGlzLmNhcnRQYXRjaCkKICAgICAgICAgIC50aGVuKCgpID0+IHsKICAgICAgICAgICAgdGhpcy5nZXRDYXJ0KGxvYWRlcikKICAgICAgICAgIH0pCiAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yLnJlc3BvbnNlLmRhdGEuZXJyb3JzKQogICAgICAgICAgfSkKICAgICAgfQogICAgICB0aGlzLmFscmVhZHlQdXQgPSB0cnVlCiAgICB9LAogICAgZ2V0Q2FydCAobG9hZGVyKSB7CiAgICAgIGNvbnN0IHVybCA9IGAke3Byb2Nlc3MuZW52LlZVRV9BUFBfQVBJUEFUSH1hcGkvJHtwcm9jZXNzLmVudi5WVUVfQVBQX1VVSUR9L2VjL3Nob3BwaW5nYAogICAgICB0aGlzLiRodHRwLmdldCh1cmwpCiAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgdGhpcy5jYXJ0ID0gcmVzLmRhdGEuZGF0YQogICAgICAgICAgaWYgKGxvYWRlcikgewogICAgICAgICAgICBsb2FkZXIuaGlkZSgpCiAgICAgICAgICB9CiAgICAgICAgICBjb25zb2xlLmxvZygpCiAgICAgICAgfSkKICAgIH0KICB9Cn0K"},{"version":3,"sources":["Product.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Product.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"product\" ref=\"product\">\n    <div class=\"router-wrapper mt-3\">\n      <router-link to=\"/\"><span class=\"mr-2 router\">首頁</span></router-link>\n      <i class=\"fas fa-chevron-right\"></i>\n      <span class=\"ml-2\">{{ product.category }}</span>\n    </div>\n    <div class=\"row mt-5\" v-if=\"product.title\">\n      <div class=\"col-7 images\">\n        <div class=\"main-img\">\n          <img :src=\"product.imageUrl? product.imageUrl[0]: ''\" class=\"w-100\">\n        </div>\n      </div>\n      <div class=\"col-5 info\">\n        <div class=\"title\">{{ product.title }}</div>\n        <div class=\"price-wrapper\">\n          <div class=\"price\">{{ product.price | priceFormat }}</div>\n          <div class=\"origin-price\">{{ product.origin_price | priceFormat }}</div>\n        </div>\n        <div class=\"discount\" v-show=\"0.85 > product.price/product.origin_price\">\n          <div class=\"badge\">\n            {{ `${(product.price/product.origin_price).toFixed(1) * 10} 折` }}\n          </div>\n          <div class=\"save-money\">\n            省下{{ product.origin_price - product.price | priceFormat }}\n          </div>\n        </div>\n        <div class=\"content\">\n            {{ product.content }}\n        </div>\n        <div class=\"rating\">\n          <span v-for=\"(score, index) in randomRating.rate\" :class=\"score\" class=\"star-item\" :key=\"index\"></span>\n          <span class=\"count\">{{ `(${randomRating.count})`  }}</span>\n        </div>\n        <div class=\"quantity\">\n          <div>數量</div>\n          <div class=\"input-area\">\n            <select class=\"form-control\" v-if=\"cartPatch.quantity <= 4\" v-model=\"cartQuantity\">\n              <option v-for=\"integer in Array.from(Array(4).keys())\" :key=\"integer\">\n                  {{ integer + 1 }}\n              </option>\n              <option value=\"5\">5+</option>\n            </select>\n            <validation-observer>\n              <validation-provider v-slot=\"{ errors }\" rules=\"required|numeric|min_value:1\">\n                <input :ref=\"`quantity-input-${product.id}`\" type=\"text\" class=\"form-control\" v-model.lazy=\"cartQuantity\" v-show=\"cartPatch.quantity > 4\">\n                <span v-if=\"errors[0]\" class=\"text-danger quantity-error\">{{ `數量${errors[0].slice((product.id.length + 16), errors[0].length)}` }}</span>\n              </validation-provider>\n            </validation-observer>\n          </div>\n        </div>\n        <div class=\"put-in-cart\">\n          <div v-if=\"!alreadyPut\" class=\"add-to-cart btn d-flex justify-content-center mt-3 mb-3\" @click=\"addToCart\">\n            <span>放入購物車</span>\n          </div>\n          <div v-if=\"alreadyPut\" class=\"go-to-checkout btn d-flex justify-content-center mt-3 mb-3\" @click=\"$router.push('/cart')\">\n            <span>立刻結帳</span>\n          </div>\n        </div>\n        <div class=\"description\">\n          {{ product.description }}\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'Product',\n  data () {\n    return {\n      product: {},\n      cart: {},\n      cartPatch: {\n        product: String,\n        quantity: 1\n      },\n      cartQuantity: 1,\n      alreadyPut: false,\n      randomRating: {\n        rate: [],\n        count: Number\n      }\n    }\n  },\n  computed: {\n    cartId: function () {\n      if (this.cart.length > 0) {\n        return this.cart.map(item => item.product.id)\n      }\n      return []\n    }\n  },\n  watch: {\n    cartQuantity: function (newValue, oldValue) {\n      let num = newValue\n      if (!/^[0-9]+$/.test(num) || num < 1) {\n        num = oldValue\n        this.cartQuantity = oldValue\n      }\n      this.cartPatch.quantity = num\n    }\n  },\n  created () {\n    const loader = this.$loading.show({\n      container: this.$refs.product,\n      opacity: 1,\n      isFullPage: true\n    })\n    const { id } = this.$route.params\n    this.cartPatch.product = id\n    const url = `${process.env.VUE_APP_APIPATH}api/${process.env.VUE_APP_UUID}/ec/product/${id}`\n    this.$http.get(url)\n      .then((res) => {\n        this.product = res.data.data\n        this.getCart(loader)\n      })\n    this.randomRating.rate = this.rating()\n    this.randomRating.count = Math.floor((50 + Math.random() * 500))\n  },\n  methods: {\n    rating () {\n      const result = []\n      const score = Math.floor((2.5 + Math.random() * 2) * 2.5) / 2\n      for (let i = 0; i < Math.floor(score); i++) {\n        result.push('on')\n      }\n      if (score % 1 !== 0) {\n        result.push('half')\n      }\n      while (result.length < 5) {\n        result.push('off')\n      }\n      return result\n    },\n    addToCart () {\n      const loader = this.$loading.show({\n        container: this.$refs.product,\n        opacity: 0.8\n      })\n      const url = `${process.env.VUE_APP_APIPATH}api/${process.env.VUE_APP_UUID}/ec/shopping`\n      let method = 'post'\n      const indexOfPatch = this.cartId.indexOf(this.cartPatch.product)\n      if (indexOfPatch >= 0) {\n        method = 'patch'\n        if (this.cart[indexOfPatch].quantity === Number(this.cartPatch.quantity)) {\n          method = 'none'\n          setTimeout(() => { loader.hide() }, 1000)\n        }\n      }\n      if (method !== 'none') {\n        this.$http[method](url, this.cartPatch)\n          .then(() => {\n            this.getCart(loader)\n          })\n          .catch((error) => {\n            console.log(error.response.data.errors)\n          })\n      }\n      this.alreadyPut = true\n    },\n    getCart (loader) {\n      const url = `${process.env.VUE_APP_APIPATH}api/${process.env.VUE_APP_UUID}/ec/shopping`\n      this.$http.get(url)\n        .then((res) => {\n          this.cart = res.data.data\n          if (loader) {\n            loader.hide()\n          }\n          console.log()\n        })\n    }\n  }\n}\n</script>\n<style lang=\"scss\">\n@import 'node_modules/bootstrap/scss/bootstrap';\n@import 'node_modules/bootstrap-vue/src/index.scss';\n$pink: #ee847d;\n$navy: #10567b;\n$blue: #2e90b7;\n$gray: #39393e;\n$light-gray: #a8a8ab;\n.product {\n  margin-top: 80px;\n  height: 100%;\n  overflow: visible;\n  max-height: none;\n  max-width: 1140px;\n  .info {\n    padding: 36px;\n    .title {\n      font-size: 26px;\n      font-weight: 700;\n      color: $gray;\n      margin-bottom: 15px;\n    }\n    .price-wrapper {\n      display: flex;\n      flex-direction: row;\n      .price {\n        height: 50px;\n        vertical-align: middle;\n        line-height: 50px;\n        font-weight: 500;\n        font-size: 24px;\n        margin-right: 20px;\n        color: $navy;\n      }\n      .origin-price {\n        height: 50px;\n        vertical-align: middle;\n        line-height: 50px;\n        text-decoration: line-through;\n        font-size: 20px;\n        color: $light-gray;\n      }\n    }\n    .discount {\n      max-width: 200px;\n      display: flex;\n      flex-direction: row;\n      margin-top: 20px;\n      border: solid 1px $pink;\n      .badge {\n        padding: 0 10px;\n        height: 50px;\n        border-radius: 2px 0 2px 0;\n        background: $pink;\n        font-weight: 700;\n        font-size: 16px;\n        color: #ffffff;\n        box-shadow: 1px 1px 2px 0 rgba(0,0,0,0.2);\n        text-align: center;\n        line-height: 50px;\n        vertical-align: middle;\n      }\n      .save-money {\n        margin-left: 20px;\n        height: 50px;\n        font-size: 16px;\n        font-weight: 700;\n        color: $gray;\n        line-height: 50px;\n        vertical-align: middle;\n      }\n    }\n    .content {\n      margin-top: 30px;\n      line-height: 30px;\n      font-weight: 500;\n    }\n    .rating {\n      margin-top: 20px;\n      .star-item{\n        display: inline-block;\n        width: 10px;\n        height: 10px;\n        margin-right: 3px;\n        background-repeat: no-repeat;\n        background-size: 10px 10px;\n      }\n      .star-item:last-child{\n        margin-right: 0;\n      }\n      .on{\n        background-image: url('../../public/images/star/star24_on@2x.png')\n      }\n      .off{\n        background-image: url('../../public/images/star/star24_off@2x.png')\n      }\n      .half{\n        background-image: url('../../public/images/star/star24_half@2x.png')\n      }\n      .count {\n        margin-left: 5px;\n        font-size: 10px;\n        font-weight: 500;\n      }\n    }\n    .quantity {\n      margin-top: 20px;\n      max-width: 100px;\n      .input-area {\n        margin-top: 20px;\n      }\n    }\n    .put-in-cart {\n      margin-top: 20px;\n      .add-to-cart {\n        color: #ffffff;\n        background-color: $pink;\n        text-decoration: none;\n        font-weight: 700;\n      }\n      .add-to-cart:hover, .add-to-cart:focus, .add-to-cart:active:hover {\n        color: #ffffff;\n        background-color: #f16c5d;\n      }\n      .go-to-checkout {\n        color: #ffffff;\n        background-color: #10567b;\n        text-decoration: none;\n      }\n      .go-to-checkout:hover, .go-to-checkout:focus, .go-to-checkout:active:hover {\n        color: #ffffff;\n        background-color: #092c3f;\n      }\n    }\n    .description {\n      color: $gray;\n      margin-top: 20px;\n    }\n  }\n  .images {\n    padding: 36px;\n  }\n}\n</style>\n"]}]}