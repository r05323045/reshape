{"remainingRequest":"/Users/apple/Desktop/git/vue_cli_try/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/apple/Desktop/git/vue_cli_try/src/views/Home.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/apple/Desktop/git/vue_cli_try/src/views/Home.vue","mtime":1596466865784},{"path":"/Users/apple/Desktop/git/vue_cli_try/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/apple/Desktop/git/vue_cli_try/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/apple/Desktop/git/vue_cli_try/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/apple/Desktop/git/vue_cli_try/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/apple/Desktop/git/vue_cli_try/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBuYXZiYXIgZnJvbSAnLi9OYXZiYXIudnVlJwppbXBvcnQgcGFnaW5hdGlvbiBmcm9tICcuL1BhZ2luYXRpb24udnVlJwppbXBvcnQgeyBCUG9wb3ZlciB9IGZyb20gJ2Jvb3RzdHJhcC12dWUnCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnaG9tZScsCiAgZGF0YSAoKSB7CiAgICByZXR1cm4gewogICAgICBwcm9kdWN0czogW10sCiAgICAgIGNhcnQ6IHt9LAogICAgICBwYWdpbmF0aW9uOiB7fQogICAgfQogIH0sCiAgY29tcG9uZW50czogewogICAgbmF2YmFyLAogICAgcGFnaW5hdGlvbiwKICAgICdiLXBvcG92ZXInOiBCUG9wb3ZlcgogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGNhcnRJZDogZnVuY3Rpb24gKCkgewogICAgICBpZiAodGhpcy5jYXJ0Lmxlbmd0aCA+IDApIHsKICAgICAgICByZXR1cm4gdGhpcy5jYXJ0Lm1hcChpdGVtID0+IGl0ZW0ucHJvZHVjdC5pZCkKICAgICAgfQogICAgICByZXR1cm4gW10KICAgIH0KICB9LAogIGNyZWF0ZWQgKCkgewogICAgdGhpcy5nZXRQcm9kdWN0cygpCiAgICB0aGlzLmdldENhcnQoKQogICAgdGhpcy4kYnVzLiRvbignY2FydFVwZGF0ZScsIGV2ZW50ID0+IHsKICAgICAgdGhpcy5jYXJ0ID0gZXZlbnQuY2FydAogICAgfSkKICB9LAogIG1ldGhvZHM6IHsKICAgIGdldFByb2R1Y3RzIChwYWdlID0gMSkgewogICAgICBjb25zdCBsb2FkZXIgPSB0aGlzLiRsb2FkaW5nLnNob3coewogICAgICAgIGNvbnRhaW5lcjogdGhpcy4kcmVmcy5ob21lLAogICAgICAgIG9wYWNpdHk6IDAuOAogICAgICB9KQogICAgICBjb25zdCB1cmwgPSBgJHtwcm9jZXNzLmVudi5WVUVfQVBQX0FQSVBBVEh9YXBpLyR7cHJvY2Vzcy5lbnYuVlVFX0FQUF9VVUlEfS9lYy9wcm9kdWN0cz9wYWdlPSR7cGFnZX1gCiAgICAgIHRoaXMuJGh0dHAuZ2V0KHVybCkKICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICB0aGlzLnByb2R1Y3RzID0gcmVzLmRhdGEuZGF0YQogICAgICAgICAgdGhpcy5wYWdpbmF0aW9uID0gcmVzLmRhdGEubWV0YS5wYWdpbmF0aW9uCiAgICAgICAgICBsb2FkZXIuaGlkZSgpCiAgICAgICAgfSkKICAgIH0sCiAgICBnZXRDYXJ0IChsb2FkZXIpIHsKICAgICAgY29uc3QgdXJsID0gYCR7cHJvY2Vzcy5lbnYuVlVFX0FQUF9BUElQQVRIfWFwaS8ke3Byb2Nlc3MuZW52LlZVRV9BUFBfVVVJRH0vZWMvc2hvcHBpbmdgCiAgICAgIHRoaXMuJGh0dHAuZ2V0KHVybCkKICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICB0aGlzLmNhcnQgPSByZXMuZGF0YS5kYXRhCiAgICAgICAgICBpZiAobG9hZGVyKSB7CiAgICAgICAgICAgIGxvYWRlci5oaWRlKCkKICAgICAgICAgIH0KICAgICAgICB9KQogICAgfSwKICAgIGFkZFRvQ2FydCAoaXRlbSwgcXVhbnRpdHkgPSAxKSB7CiAgICAgIGNvbnN0IGxvYWRlciA9IHRoaXMuJGxvYWRpbmcuc2hvdyh7CiAgICAgICAgY29udGFpbmVyOiB0aGlzLiRyZWZzLmhvbWUsCiAgICAgICAgb3BhY2l0eTogMC44CiAgICAgIH0pCiAgICAgIGNvbnN0IHVybCA9IGAke3Byb2Nlc3MuZW52LlZVRV9BUFBfQVBJUEFUSH1hcGkvJHtwcm9jZXNzLmVudi5WVUVfQVBQX1VVSUR9L2VjL3Nob3BwaW5nYAogICAgICBjb25zdCBjYXJ0ID0gewogICAgICAgIHByb2R1Y3Q6IGl0ZW0uaWQsCiAgICAgICAgcXVhbnRpdHkKICAgICAgfQogICAgICB0aGlzLiRodHRwLnBvc3QodXJsLCBjYXJ0KQogICAgICAgIC50aGVuKCgpID0+IHsKICAgICAgICAgIHRoaXMuZ2V0Q2FydChsb2FkZXIpCiAgICAgICAgICB0aGlzLiRyZWZzW2Bwb3BvdmVyLSR7aXRlbS5pZH1gXVswXS4kZW1pdCgnY2xvc2UnKQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gewogICAgICAgICAgY29uc29sZS5sb2coZXJyb3IucmVzcG9uc2UuZGF0YS5lcnJvcnMpCiAgICAgICAgfSkKICAgIH0sCiAgICByYXRpbmcgKCkgewogICAgICBjb25zdCByZXN1bHQgPSBbXQogICAgICBjb25zdCBzY29yZSA9IE1hdGguZmxvb3IoKDIuNSArIE1hdGgucmFuZG9tKCkgKiAyKSAqIDIuNSkgLyAyCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgTWF0aC5mbG9vcihzY29yZSk7IGkrKykgewogICAgICAgIHJlc3VsdC5wdXNoKCdvbicpCiAgICAgIH0KICAgICAgaWYgKHNjb3JlICUgMSAhPT0gMCkgewogICAgICAgIHJlc3VsdC5wdXNoKCdoYWxmJykKICAgICAgfQogICAgICB3aGlsZSAocmVzdWx0Lmxlbmd0aCA8IDUpIHsKICAgICAgICByZXN1bHQucHVzaCgnb2ZmJykKICAgICAgfQogICAgICByZXR1cm4gcmVzdWx0CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"home mx-auto\" ref=\"home\">\n    <navbar :cart=\"cart\" ref=\"navbar\"></navbar>\n    <div class=\"products\" v-if=\"this.$route.path === '/'\">\n      <div class=\"mt-5 mb-2\">\n        <h3 class=\"title\">廚房餐桌</h3>\n      </div>\n      <div v-for=\"i in 5\" :key=\"`row_${i}`\">\n        <div class=\"card-deck mx-auto\" v-if=\"products.slice((i - 1) * 5, i * 5).length > 0\">\n          <div v-for=\"item in products.slice((i - 1) * 5, i * 5)\" :key=\"item.id\" class=\"card my-5\" :id=\"item.id\"  @click=\"$router.push(`/product/${item.id}`)\">\n            <img :src=\"item.imageUrl[0]\" class=\"card-img-top\">\n            <div class=\"discount-badge\" v-show=\"0.85 > item.price/item.origin_price\">{{ `${(item.price/item.origin_price).toFixed(1) * 10} 折` }}\n            </div>\n            <div class=\"card-body\">\n              <p class=\"card-title\">{{ item.title }}</p>\n              <div class=\"price-wrapper\">\n                <span class=\"price\">{{ item.price | priceFormat }}</span>\n                <span class=\"original-price\" v-show=\"item.origin_price > item.price\">{{ item.origin_price | priceFormat }}</span>\n              </div>\n            </div>\n            <b-popover :target=\"item.id\" triggers=\"hover focus\" placement=\"right\" class=\"product-popper\" :ref=\"`popover-${item.id}`\">\n              <div class=\"popper-wrapper\">\n                <div class=\"popper-title mt-3\">\n                    {{ item.title }}\n                </div>\n                <span class=\"btn btn-light popper-badge\"> {{ item.category }} </span>\n                <div class=\"popper-content mt-2\">\n                    {{ item.content }}\n                </div>\n                <div class=\"popper-star mt-3\">\n                  <span v-for=\"(score, index) in rating()\" :class=\"score\" class=\"star-item\" :key=\"index\"></span>\n                </div>\n                <div class=\"popper-price mt-3\">\n                  <span class=\"price\">{{ item.price | priceFormat }}</span>\n                  <span class=\"original-price\" v-show=\"item.origin_price > item.price\">{{ item.origin_price | priceFormat }}</span>\n                </div>\n                <div v-if=\"!cartId.includes(item.id)\" :class=\"{ addToCart: !cartId.includes(item.id), goToCheckout: cartId.includes(item.id) }\" class=\"btn d-flex justify-content-center mt-3 mb-3\" @click=\"addToCart(item)\">\n                  <span>放入購物車</span>\n                </div>\n                <div v-if=\"cartId.includes(item.id)\" :class=\"{ addToCart: !cartId.includes(item.id), goToCheckout: cartId.includes(item.id) }\" class=\"btn d-flex justify-content-center mt-3 mb-3\" @click=\"$router.push('/cart')\">\n                  <span>立刻結帳</span>\n                </div>\n                <div v-if=\"cartId.includes(item.id)\" class=\"popper-description mt-2\">\n                  {{ item.description }}\n                </div>\n              </div>\n            </b-popover>\n          </div>\n          <div class=\"card my-5 border-0\" v-for=\"i in 5 - products.slice((i - 1) * 5, i * 5).length\" :key=\"`surplus_${i}`\">\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"modal fade\" id=\"orderModal\" tabindex=\"-1\" role=\"dialog\">\n      <div class=\"modal-dialog modal-dialog-centered\" role=\"document\">\n        <div class=\"modal-content\">\n          <div class=\"modal-header\">\n            <h5 class=\"modal-title\">完成訂購</h5>\n            <button type=\"button\" class=\"close\" data-dismiss=\"modal\">\n              <span>&times;</span>\n            </button>\n          </div>\n          <div class=\"modal-body text-center\">\n            <p>感謝你的購買，請耐心等候到貨通知</p>\n          </div>\n          <div class=\"modal-footer\">\n            <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">關閉</button>\n          </div>\n        </div>\n      </div>\n    </div>\n    <pagination :pages=\"pagination\" @emit-pages=\"getProducts\" class=\"pagination-wrapper my-3\" v-if=\"this.$route.path === '/'\"></pagination>\n  </div>\n</template>\n\n<script>\nimport navbar from './Navbar.vue'\nimport pagination from './Pagination.vue'\nimport { BPopover } from 'bootstrap-vue'\nexport default {\n  name: 'home',\n  data () {\n    return {\n      products: [],\n      cart: {},\n      pagination: {}\n    }\n  },\n  components: {\n    navbar,\n    pagination,\n    'b-popover': BPopover\n  },\n  computed: {\n    cartId: function () {\n      if (this.cart.length > 0) {\n        return this.cart.map(item => item.product.id)\n      }\n      return []\n    }\n  },\n  created () {\n    this.getProducts()\n    this.getCart()\n    this.$bus.$on('cartUpdate', event => {\n      this.cart = event.cart\n    })\n  },\n  methods: {\n    getProducts (page = 1) {\n      const loader = this.$loading.show({\n        container: this.$refs.home,\n        opacity: 0.8\n      })\n      const url = `${process.env.VUE_APP_APIPATH}api/${process.env.VUE_APP_UUID}/ec/products?page=${page}`\n      this.$http.get(url)\n        .then((res) => {\n          this.products = res.data.data\n          this.pagination = res.data.meta.pagination\n          loader.hide()\n        })\n    },\n    getCart (loader) {\n      const url = `${process.env.VUE_APP_APIPATH}api/${process.env.VUE_APP_UUID}/ec/shopping`\n      this.$http.get(url)\n        .then((res) => {\n          this.cart = res.data.data\n          if (loader) {\n            loader.hide()\n          }\n        })\n    },\n    addToCart (item, quantity = 1) {\n      const loader = this.$loading.show({\n        container: this.$refs.home,\n        opacity: 0.8\n      })\n      const url = `${process.env.VUE_APP_APIPATH}api/${process.env.VUE_APP_UUID}/ec/shopping`\n      const cart = {\n        product: item.id,\n        quantity\n      }\n      this.$http.post(url, cart)\n        .then(() => {\n          this.getCart(loader)\n          this.$refs[`popover-${item.id}`][0].$emit('close')\n        })\n        .catch((error) => {\n          console.log(error.response.data.errors)\n        })\n    },\n    rating () {\n      const result = []\n      const score = Math.floor((2.5 + Math.random() * 2) * 2.5) / 2\n      for (let i = 0; i < Math.floor(score); i++) {\n        result.push('on')\n      }\n      if (score % 1 !== 0) {\n        result.push('half')\n      }\n      while (result.length < 5) {\n        result.push('off')\n      }\n      return result\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n@import 'node_modules/bootstrap/scss/bootstrap';\n@import 'node_modules/bootstrap-vue/src/index.scss';\n$pink: #ee847d;\n$navy: #10567b;\n$blue: #2e90b7;\n$gray: #39393e;\n$light-gray: #a8a8ab;\n.home {\n  margin-top: 120px;\n  max-width: 1140px;\n  .router-link-active {\n    color: $blue;\n  }\n  .products {\n    .card-deck {\n      .card {\n        cursor: pointer;\n        height: 300px;\n        .card-img-top {\n          height: 160px;\n        }\n        .discount-badge {\n          position: absolute;\n          top: 0;\n          left: 0;\n          border-radius: 2px 0 2px 0;\n          z-index: 5;\n          background: $pink;\n          font-weight: 700;\n          font-size: 14px;\n          color: #ffffff;\n          box-shadow: 1px 1px 2px 0 rgba(0,0,0,0.2);\n          text-align: center;\n          padding: 5px 6px;\n          line-height: 1;\n        }\n        .card-body {\n          display: flex;\n          flex-direction: column;\n          justify-content: center;\n          align-items: center;\n          height: 180px;\n          .card-title {\n            flex-grow: 3;\n            font-size: 16px;\n            font-weight: 700;\n            color: $gray;\n            margin-bottom: 15px;\n          }\n          .price-wrapper {\n            flex-grow: 1;\n            width: 100%;\n            bottom: 10px;\n            .price {\n              vertical-align: middle;\n              font-weight: 500;\n              font-size: 16px;\n              margin-right: 6px;\n              color: $navy;\n            }\n            .original-price {\n              vertical-align: middle;\n              text-decoration: line-through;\n              font-size: 14px;\n              line-height: 20px;\n              color: $light-gray;\n            }\n          }\n        }\n      }\n    }\n  }\n}\n.popper-wrapper {\n  border-radius: 30%;\n  padding: 15px;\n  .popper-badge {\n    display: inline-block;\n    white-space: nowrap;\n    font-size: 12px;\n    margin: 3px;\n    padding: 3px 6px;\n    color: #919191;\n  }\n  .popper-title {\n    font-size: 16px;\n    font-weight: 700;\n    color: #39393e;\n    margin-bottom: 15px;\n  }\n  .popper-star {\n    font-size: 0;\n    .star-item{\n      display: inline-block;\n      width: 10px;\n      height: 10px;\n      margin-right: 3px;\n      background-repeat: no-repeat;\n      background-size: 10px 10px;\n    }\n    .star-item:last-child{\n      margin-right: 0;\n    }\n    .on{\n      background-image: url('../../public/images/star/star24_on@2x.png')\n    }\n    .off{\n      background-image: url('../../public/images/star/star24_off@2x.png')\n    }\n    .half{\n      background-image: url('../../public/images/star/star24_half@2x.png')\n    }\n  }\n  .popper-price {\n    .price {\n      vertical-align: middle;\n      font-weight: 500;\n      font-size: 16px;\n      margin-right: 6px;\n      color: $navy;\n    }\n    .original-price {\n      vertical-align: middle;\n      text-decoration: line-through;\n      font-size: 14px;\n      line-height: 20px;\n      color: $light-gray;\n    }\n  }\n  .popper-description {\n    font-size: 10px;\n  }\n  .addToCart {\n    color: #ffffff;\n    background-color: #ec5252;\n    text-decoration: none;\n  }\n  .addToCart:hover, .add-to-cartaddToCart:focus, .addToCart:active:hover {\n    color: #ffffff;\n    background-color: #c93232;\n  }\n  .goToCheckout {\n    color: #ffffff;\n    background-color: #10567b;\n    text-decoration: none;\n  }\n  .goToCheckout:hover, .goToCheckout:focus, .goToCheckout:active:hover {\n    color: #ffffff;\n    background-color: #092c3f;\n  }\n}\n</style>\n"]}]}