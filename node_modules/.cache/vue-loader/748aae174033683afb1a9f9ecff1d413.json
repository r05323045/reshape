{"remainingRequest":"/Users/apple/Desktop/git/vue_cli_try/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/apple/Desktop/git/vue_cli_try/src/views/Cart.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/apple/Desktop/git/vue_cli_try/src/views/Cart.vue","mtime":1596378464409},{"path":"/Users/apple/Desktop/git/vue_cli_try/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/apple/Desktop/git/vue_cli_try/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/apple/Desktop/git/vue_cli_try/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/apple/Desktop/git/vue_cli_try/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBjaGVja291dCBmcm9tICcuL0NoZWNrb3V0LnZ1ZScKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdDYXJ0JywKICBkYXRhICgpIHsKICAgIHJldHVybiB7CiAgICAgIGNhcnQ6IHt9LAogICAgICBjaGVja2luZ291dDogZmFsc2UKICAgIH0KICB9LAogIGNvbXBvbmVudHM6IHsKICAgIGNoZWNrb3V0CiAgfSwKICBjcmVhdGVkICgpIHsKICAgIGNvbnN0IGxvYWRlciA9IHRoaXMuJGxvYWRpbmcuc2hvdyh7CiAgICAgIGNvbnRhaW5lcjogdGhpcy4kcmVmcy5jYXJ0LAogICAgICBvcGFjaXR5OiAxLAogICAgICBpc0Z1bGxQYWdlOiB0cnVlCiAgICB9KQogICAgdGhpcy5nZXRDYXJ0KGxvYWRlcikKICB9LAogIGNvbXB1dGVkOiB7CiAgICBjYXJ0VG90YWw6IGZ1bmN0aW9uICgpIHsKICAgICAgbGV0IHRvdGFsID0gMAogICAgICB0aGlzLmNhcnQuZm9yRWFjaCgoaXRlbSkgPT4gewogICAgICAgIHRvdGFsICs9IGl0ZW0ucHJvZHVjdC5wcmljZSAqIGl0ZW0ucXVhbnRpdHkKICAgICAgfSkKICAgICAgcmV0dXJuIHRvdGFsCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBnZXRDYXJ0IChsb2FkZXIpIHsKICAgICAgY29uc3QgdXJsID0gYCR7cHJvY2Vzcy5lbnYuVlVFX0FQUF9BUElQQVRIfWFwaS8ke3Byb2Nlc3MuZW52LlZVRV9BUFBfVVVJRH0vZWMvc2hvcHBpbmdgCiAgICAgIHRoaXMuJGh0dHAuZ2V0KHVybCkKICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICB0aGlzLmNhcnQgPSByZXMuZGF0YS5kYXRhCiAgICAgICAgICBpZiAobG9hZGVyKSB7CiAgICAgICAgICAgIGxvYWRlci5oaWRlKCkKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuJGJ1cy4kZW1pdCgnY2FydFVwZGF0ZScsIHsKICAgICAgICAgICAgY2FydDogdGhpcy5jYXJ0CiAgICAgICAgICB9KQogICAgICAgIH0pCiAgICB9LAogICAgcXVhbnRpdHlVcGRhdGEgKGlkLCBudW0pIHsKICAgICAgY29uc3QgbG9hZGVyID0gdGhpcy4kbG9hZGluZy5zaG93KHsKICAgICAgICBjb250YWluZXI6IHRoaXMuJHJlZnMuY2FydCwKICAgICAgICBvcGFjaXR5OiAxLAogICAgICAgIGlzRnVsbFBhZ2U6IHRydWUKICAgICAgfSkKICAgICAgaWYgKCEvXlswLTldKyQvLnRlc3QobnVtKSB8fCBudW0gPCAxKSB7CiAgICAgICAgbnVtID0gMQogICAgICB9CiAgICAgIGNvbnN0IHVybCA9IGAke3Byb2Nlc3MuZW52LlZVRV9BUFBfQVBJUEFUSH1hcGkvJHtwcm9jZXNzLmVudi5WVUVfQVBQX1VVSUR9L2VjL3Nob3BwaW5nYAogICAgICBjb25zdCBkYXRhID0gewogICAgICAgIHByb2R1Y3Q6IGlkLAogICAgICAgIHF1YW50aXR5OiBudW0KICAgICAgfQogICAgICB0aGlzLiRodHRwLnBhdGNoKHVybCwgZGF0YSkudGhlbigoKSA9PiB7CiAgICAgICAgdGhpcy5nZXRDYXJ0KGxvYWRlcikKICAgICAgfSkKICAgIH0sCiAgICByZW1vdmVBbGxDYXJ0SXRlbSAoKSB7CiAgICAgIGNvbnN0IGxvYWRlciA9IHRoaXMuJGxvYWRpbmcuc2hvdyh7CiAgICAgICAgY29udGFpbmVyOiB0aGlzLiRyZWZzLmNhcnQsCiAgICAgICAgb3BhY2l0eTogMSwKICAgICAgICBpc0Z1bGxQYWdlOiB0cnVlCiAgICAgIH0pCiAgICAgIGNvbnN0IHVybCA9IGAke3Byb2Nlc3MuZW52LlZVRV9BUFBfQVBJUEFUSH1hcGkvJHtwcm9jZXNzLmVudi5WVUVfQVBQX1VVSUR9L2VjL3Nob3BwaW5nL2FsbC9wcm9kdWN0YAogICAgICB0aGlzLiRodHRwLmRlbGV0ZSh1cmwpCiAgICAgICAgLnRoZW4oKCkgPT4gewogICAgICAgICAgdGhpcy5nZXRDYXJ0KGxvYWRlcikKICAgICAgICB9KQogICAgfSwKICAgIHJlbW92ZUNhcnRJdGVtIChpZCkgewogICAgICBjb25zdCBsb2FkZXIgPSB0aGlzLiRsb2FkaW5nLnNob3coewogICAgICAgIGNvbnRhaW5lcjogdGhpcy4kcmVmcy5jYXJ0LAogICAgICAgIG9wYWNpdHk6IDEsCiAgICAgICAgaXNGdWxsUGFnZTogdHJ1ZQogICAgICB9KQogICAgICBjb25zdCB1cmwgPSBgJHtwcm9jZXNzLmVudi5WVUVfQVBQX0FQSVBBVEh9YXBpLyR7cHJvY2Vzcy5lbnYuVlVFX0FQUF9VVUlEfS9lYy9zaG9wcGluZy8ke2lkfWAKICAgICAgdGhpcy4kaHR0cC5kZWxldGUodXJsKS50aGVuKCgpID0+IHsKICAgICAgICB0aGlzLmdldENhcnQobG9hZGVyKQogICAgICB9KQogICAgfSwKICAgIGNhcnRPckNoZWNrb3V0ICgpIHsKICAgICAgdGhpcy5jaGVja2luZ291dCA9ICF0aGlzLmNoZWNraW5nb3V0CiAgICAgIHRoaXMuJHJlZnMuY2hlY2tvdXQuJHJlZnMuZm9ybXZhbGlkYXRpb24ucmVzZXQoKQogICAgICB0aGlzLiRyZWZzLmNoZWNrb3V0LiRyZWZzLmNoZWNrb3V0Zm9ybS5yZXNldCgpCiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["Cart.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Cart.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <div class=\"cart\" v-show=\"!checkingout\" ref=\"cart\">\n      <div class=\"router-wrapper mt-3\">\n        <router-link to=\"/\"><span class=\"mr-2 router\">首頁</span></router-link>\n        <i class=\"fas fa-chevron-right\"></i>\n        <span class=\"ml-2\">購物車</span>\n      </div>\n      <div class=\"my-5 cart-step-wrapper d-flex justify-content-center mx-auto\" v-if=\"cart.length\">\n        <div class=\"cart-step row\">\n          <div class=\"cart-step-icon\">1</div>\n          <div class=\"cart-step-text\">\n              <div>購買品項</div>\n          </div>\n          <div class=\"connector-line\"></div>\n        </div>\n        <div class=\"checkout-step row\">\n          <div class=\"checkout-step-icon\">2</div>\n          <div class=\"checkout-step-text\">填寫地址與結帳</div>\n        </div>\n      </div>\n      <div class=\"empty-cart w-100 text-center my-5\" v-if=\"!cart.length\">\n        <div class=\"text-align-center\">\n          <h1 class=\"mt-5\">你的購物車中沒有商品</h1>\n          <router-link to=\"/\"><div class=\"btn mt-5 back-to-homepage\">回首頁選購</div></router-link>\n          <router-link to=\"/\"><div class=\"btn mt-5 ml-3 back-to-homepage\">我不要</div></router-link>\n        </div>\n      </div>\n      <div class=\"row\">\n        <div class=\"col-8 cart-board\">\n          <div class=\"table-wrapper d-flex flex-column\">\n            <table class=\"table\">\n              <tbody v-if=\"cart.length\">\n                <tr v-for=\"item in cart\" :key=\"item.id\">\n                <td class=\"td-img\" :class=\"{ borderless : cart.length === 1}\">\n                  <div class=\"img-wrapper mx-auto my-auto\">\n                  <img :src=\"item.product.imageUrl\" class=\"cart-image\" @click=\"$router.push(`/product/${item.product.id}`)\">\n                  </div>\n                </td>\n                <td class=\"align-middle td-title\" :class=\"{ borderless : cart.length === 1}\">\n                    {{ item.product.title }}\n                </td>\n                <td class=\"align-middle td-quantity\" :class=\"{ borderless : cart.length === 1}\">\n                  <select class=\"form-control\" v-if=\"item.quantity <= 4\" v-model=\"item.quantity\" @change=\"quantityUpdata(item.product.id, item.quantity)\">\n                    <option v-for=\"integer in Array.from(Array(4).keys())\" :key=\"integer\">\n                        {{ integer + 1 }}\n                    </option>\n                    <option value=\"5\">5+</option>\n                  </select>\n                  <validation-observer>\n                    <form @submit.prevent=\"\">\n                      <validation-provider v-slot=\"{ errors }\" rules=\"required|numeric|min_value:1\">\n                        <input :id=\"`quantity-input-${item.product.id}`\" type=\"text\" class=\"form-control\" v-model.lazy=\"item.quantity\" @change=\"quantityUpdata(item.product.id, item.quantity)\" v-show=\"item.quantity > 4\">\n                        <span v-if=\"errors[0]\" class=\"text-danger td-quantity-error\">{{ `數量${errors[0].slice((item.product.id.length + 16), errors[0].length)}` }}</span>\n                      </validation-provider>\n                    </form>\n                  </validation-observer>\n                </td>\n                <td class=\"align-middle text-right td-amount\" :class=\"{ borderless : cart.length === 1}\">\n                  {{ item.product.price * item.quantity | priceFormat }}\n                </td>\n                <td class=\"align-middle\" :class=\"{ borderless : cart.length === 1}\">\n                  <button class=\"btn\" @click=\"removeCartItem(item.product.id)\">\n                    <i class=\"fa fa-times\"></i>\n                  </button>\n                </td>\n                </tr>\n              </tbody>\n            </table>\n            <div class=\"clear-cart-wrapper mb-3 flex-grow-1 d-flex align-items-end\" v-if=\"cart.length\">\n              <div class=\"clear-cart\" @click=\"removeAllCartItem()\">清空購物車</div>\n            </div>\n          </div>\n        </div>\n        <div class=\"col-4 cart-summary\" v-if=\"cart.length\">\n          <div class=\"card cart-card mx-auto\">\n            <div class=\"card-header\">\n              訂單摘要\n            </div>\n            <div class=\"card-body d-flex flex-column\">\n              <ul class=\"list-group h-100\">\n                <li class=\"list-group-item d-flex justify-content-between\">\n                  <span>商品總計</span>\n                  <span>{{ cartTotal | priceFormat}}</span>\n                </li>\n                <li class=\"list-group-item d-flex justify-content-between\">\n                  <span>運費總計</span>\n                  <span>NT$ 0</span>\n                </li>\n                <div class=\"divider-wrapper\">\n                  <div class=\"divider\"></div>\n                </div>\n                <div class=\"list-group-item d-flex w-100 pt-2\">\n                    <div class=\"cart-total w-100 d-flex justify-content-between\">\n                        <span>結帳金額</span>\n                        <span>{{ cartTotal | priceFormat}}</span>\n                    </div>\n                </div>\n                <div class=\"list-group-item\">\n                    <div class=\"goToCheckout btn d-flex justify-content-center\" @click=\"cartOrCheckout\">\n                      前往結帳\n                    </div>\n                </div>\n              </ul>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <checkout :cart=\"cart\" v-show=\"checkingout\" @backtocart=\"cartOrCheckout\" ref=\"checkout\"></checkout>\n  </div>\n</template>\n\n<script>\nimport checkout from './Checkout.vue'\nexport default {\n  name: 'Cart',\n  data () {\n    return {\n      cart: {},\n      checkingout: false\n    }\n  },\n  components: {\n    checkout\n  },\n  created () {\n    const loader = this.$loading.show({\n      container: this.$refs.cart,\n      opacity: 1,\n      isFullPage: true\n    })\n    this.getCart(loader)\n  },\n  computed: {\n    cartTotal: function () {\n      let total = 0\n      this.cart.forEach((item) => {\n        total += item.product.price * item.quantity\n      })\n      return total\n    }\n  },\n  methods: {\n    getCart (loader) {\n      const url = `${process.env.VUE_APP_APIPATH}api/${process.env.VUE_APP_UUID}/ec/shopping`\n      this.$http.get(url)\n        .then((res) => {\n          this.cart = res.data.data\n          if (loader) {\n            loader.hide()\n          }\n          this.$bus.$emit('cartUpdate', {\n            cart: this.cart\n          })\n        })\n    },\n    quantityUpdata (id, num) {\n      const loader = this.$loading.show({\n        container: this.$refs.cart,\n        opacity: 1,\n        isFullPage: true\n      })\n      if (!/^[0-9]+$/.test(num) || num < 1) {\n        num = 1\n      }\n      const url = `${process.env.VUE_APP_APIPATH}api/${process.env.VUE_APP_UUID}/ec/shopping`\n      const data = {\n        product: id,\n        quantity: num\n      }\n      this.$http.patch(url, data).then(() => {\n        this.getCart(loader)\n      })\n    },\n    removeAllCartItem () {\n      const loader = this.$loading.show({\n        container: this.$refs.cart,\n        opacity: 1,\n        isFullPage: true\n      })\n      const url = `${process.env.VUE_APP_APIPATH}api/${process.env.VUE_APP_UUID}/ec/shopping/all/product`\n      this.$http.delete(url)\n        .then(() => {\n          this.getCart(loader)\n        })\n    },\n    removeCartItem (id) {\n      const loader = this.$loading.show({\n        container: this.$refs.cart,\n        opacity: 1,\n        isFullPage: true\n      })\n      const url = `${process.env.VUE_APP_APIPATH}api/${process.env.VUE_APP_UUID}/ec/shopping/${id}`\n      this.$http.delete(url).then(() => {\n        this.getCart(loader)\n      })\n    },\n    cartOrCheckout () {\n      this.checkingout = !this.checkingout\n      this.$refs.checkout.$refs.formvalidation.reset()\n      this.$refs.checkout.$refs.checkoutform.reset()\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.cart {\n  margin-top: 80px;\n  height: 100%;\n  overflow: visible;\n  max-height: none;\n  max-width: 1140px;\n  background: #ffffff;\n  .router-wraper {\n    .router {\n      width: 100%;\n      cursor: pointer;\n    }\n    .router:hover {\n      text-decoration: underline;\n    }\n  }\n  .cart-step-wrapper {\n    .cart-step {\n      width: 300px;\n      position: relative;\n    }\n    .cart-step-icon {\n        z-index: 999;\n        text-align: center;\n        vertical-align: middle;\n        line-height: 50px;\n        background-color: #10567b;\n        color: #ffffff;\n        border-radius: 50%;\n        width: 50px;\n        height: 50px;\n    }\n    .cart-step-text {\n        padding-left: 15px;\n        padding-right: 10px;\n        z-index: 999;\n        background-color: #ffffff;\n        display: inline-block;\n        text-align: center;\n        vertical-align: middle;\n        line-height: 50px;\n        height: 50px;\n    }\n    .checkout-step-icon {\n        z-index: 999;\n        text-align: center;\n        vertical-align: middle;\n        line-height: 50px;\n        background-color: #919191;\n        color: #ffffff;\n        border-radius: 50%;\n        width: 50px;\n        height: 50px;\n    }\n    .checkout-step-text {\n        padding-left: 15px;\n        padding-right: 10px;\n        z-index: 999;\n        color: #919191;\n        background-color: #ffffff;\n        display: inline-block;\n        text-align: center;\n        vertical-align: middle;\n        line-height: 50px;\n        height: 50px;\n    }\n    .connector-line {\n        z-index: 1;\n        position: absolute;\n        left: 0;\n        top: 23px;\n        background-color: #919191;\n        width: 100%;\n        height: 2px;\n        vertical-align: middle;\n    }\n  }\n  .empty-cart {\n    height: 100%;\n    .back-to-homepage {\n      color: #39393e;\n      border: 1px solid #a8a8ab;\n      padding: 8px\n    }\n    .back-to-homepage:hover, .back-to-homepage:focus, .back-to-homepage:active:hover {\n      color: #ffffff;\n      background-color: #919191;\n    }\n  }\n  .row {\n    .cart-board {\n      .table-wrapper {\n        width: 100%;\n        height: 100%;\n        box-sizing: border-box;\n        .borderless {\n            border-top: 0 none !important;\n        }\n        .td-title {\n          max-width: 200px;\n        }\n        .td-img {\n          max-width: 100px;\n          .cart-image {\n            cursor: pointer;\n            max-width: 100%;\n            max-height: 100%;\n            border-radius: 10px;\n          }\n        }\n        .td-quantity {\n          position: relative;\n          width: 80px;\n          .td-quantity-error {\n            top: 60px;\n            width: 100px;\n            position: absolute;\n          }\n        }\n        .td-amount {\n          width: 144px;\n        }\n        .clear-cart-wrapper {\n          position: relative;\n          .clear-cart {\n            position: absolute;\n            right: 40px;\n            cursor: pointer;\n            color: #2e90b7;\n          }\n          .clear-cart:hover {\n            text-decoration: underline;\n          }\n        }\n      }\n    }\n  }\n}\n.cart-summary {\n  .cart-card {\n    width: 300px;\n    .divider {\n      display: block;\n      height: 2px;\n      background-color: #eeeeef;\n      margin-top: 20px;\n    }\n    .list-group-item {\n      border: none !important;\n      .goToCheckout {\n        color: #ffffff;\n        background-color: #10567b;\n        text-decoration: none;\n        a {\n          color: #ffffff;\n          text-decoration: none;\n        }\n      }\n      .goToCheckout:hover, .goToCheckout:focus, .goToCheckout:active:hover {\n        color: #ffffff;\n        background-color: #092c3f;\n      }\n    }\n  }\n}\n</style>\n"]}]}