(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-49503870"],{2532:function(t,e,a){"use strict";var o=a("23e7"),s=a("5a34"),r=a("1d80"),i=a("ab13");o({target:"String",proto:!0,forced:!i("includes")},{includes:function(t){return!!~String(r(this)).indexOf(s(t),arguments.length>1?arguments[1]:void 0)}})},"2a23":function(t,e,a){"use strict";var o=a("3c9e"),s=a.n(o);s.a},"2fd4":function(t,e,a){"use strict";var o=a("6b2a"),s=a.n(o);s.a},"3c9e":function(t,e,a){},"44e7":function(t,e,a){var o=a("861d"),s=a("c6b6"),r=a("b622"),i=r("match");t.exports=function(t){var e;return o(t)&&(void 0!==(e=t[i])?!!e:"RegExp"==s(t))}},"5a34":function(t,e,a){var o=a("44e7");t.exports=function(t){if(o(t))throw TypeError("The method doesn't accept regular expressions");return t}},"6b2a":function(t,e,a){},"6d09":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"backend-products",staticClass:"backend-products"},[a("loading",{attrs:{active:t.isLoading},on:{"update:active":function(e){t.isLoading=e}}}),a("div",{staticClass:"above-table text-right mt-4"},[a("button",{staticClass:"btn create-product",on:{click:function(e){return t.openModal("new")}}},[t._v(" ＋ ADD ITEM ")])]),a("div",{staticClass:"table-wrapper"},[a("table",{staticClass:"table mt-4"},[t._m(0),a("tbody",t._l(t.products,(function(e){return a("tr",{key:e.id},[a("td",{staticClass:"td-img"},[a("div",{staticClass:"img-wrapper mx-auto my-auto"},[a("img",{staticClass:"product-image",attrs:{src:e.imageUrl}})])]),a("td",[t._v(t._s(e.category))]),a("td",[t._v(t._s(e.title))]),a("td",[t._v(t._s(e.origin_price))]),a("td",[t._v(t._s(e.price))]),a("td",[a("div",{staticClass:"onoffswitch mx-auto align-middle"},[a("input",{staticClass:"onoffswitch-checkbox",class:{checked:e.enabled},attrs:{type:"checkbox",name:"onoffswitch",id:"switch-"+e.id,tabindex:"0",checked:""},on:{click:function(a){return t.switchToActive(e)}}}),a("label",{staticClass:"onoffswitch-label",attrs:{for:"switch-"+e.id}})])]),a("td",[a("button",{staticClass:"btn btn-sm",attrs:{"data-toggle":"tooltip",title:"編輯產品"},on:{click:function(a){return t.openModal("edit",e)},mouseover:t.toolTip}},[a("i",{staticClass:"fa fa-edit fa-lg"})]),a("button",{staticClass:"btn btn-sm",attrs:{"data-toggle":"tooltip",title:"刪除產品"},on:{click:function(a){return t.openModal("delete",e)},mouseover:t.toolTip}},[a("i",{staticClass:"fa fa-trash fa-lg"})])])])})),0)])]),a("pagination",{staticClass:"pagination-wrapper",attrs:{pages:t.pagination},on:{"emit-pages":t.getProducts}}),a("product-modal",{ref:"productModel",attrs:{"is-new":t.isNew,token:t.token},on:{loading:t.loadingSwitch}}),a("del-product-modal",{attrs:{"temp-product":t.tempProduct,token:t.token},on:{update:t.getProducts}})],1)},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",{staticClass:"thead-dark"},[a("tr",[a("th"),a("th",[t._v("分類")]),a("th",[t._v("產品名稱")]),a("th",[t._v("原價")]),a("th",[t._v("售價")]),a("th",[t._v("啟用")]),a("th")])])}],r=(a("99af"),a("4160"),a("caad"),a("d81d"),a("2532"),a("159b"),a("1157")),i=a.n(r),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"productModal",staticClass:"modal fade",attrs:{id:"productModal"}},[a("div",{staticClass:"modal-dialog modal-lg",attrs:{role:"document"}},[a("validation-observer",{ref:"form",scopedSlots:t._u([{key:"default",fn:function(e){var o=e.invalid;return[a("form",{on:{submit:function(e){return e.preventDefault(),t.updateProduct(t.tempProduct)}}},[a("div",{staticClass:"modal-content border-0"},[a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v(" "+t._s(t.modalView.title)+" ")]),a("i",{staticClass:"fa fa-times-circle fa-2x",attrs:{"data-dismiss":"modal"}})]),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-4"},[a("div",{staticClass:"form-group"},[a("validation-provider",{attrs:{rules:{required:!0,regex:/^(http:\/\/www\.|https:\/\/www\.|http:\/\/|https:\/\/)?[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?$/}},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.errors,s=e.classes;return[a("label",{attrs:{for:"imageUrl"}},[t._v("輸入圖片網址")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProduct.imageUrl[0],expression:"tempProduct.imageUrl[0]"}],staticClass:"form-control",class:s,attrs:{id:"imageUrl",type:"text",placeholder:"請輸入圖片連結"},domProps:{value:t.tempProduct.imageUrl[0]},on:{input:function(e){e.target.composing||t.$set(t.tempProduct.imageUrl,0,e.target.value)}}}),o[0]?a("span",{staticClass:"text-danger"},[t._v(t._s("圖片連結"+o[0].slice(9,o[0].length)))]):t._e()]}}],null,!0)})],1),a("div",{staticClass:"modal-img-wrapper text-center"},[a("img",{staticClass:"img-fluid product-image",attrs:{src:t.tempProduct.imageUrl[0],alt:""}})])]),a("div",{staticClass:"col-sm-8"},[a("div",[a("div",{staticClass:"form-row"},[a("div",{staticClass:"form-group col-md-6"},[a("validation-provider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.errors,s=e.classes;return[a("label",{attrs:{for:"title"}},[t._v("標題")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProduct.title,expression:"tempProduct.title"}],staticClass:"form-control",class:s,attrs:{id:"title",type:"text",placeholder:"請輸入標題"},domProps:{value:t.tempProduct.title},on:{input:function(e){e.target.composing||t.$set(t.tempProduct,"title",e.target.value)}}}),o[0]?a("span",{staticClass:"text-danger"},[t._v(t._s("標題"+o[0].slice(6,o[0].length)))]):t._e()]}}],null,!0)})],1),a("div",{staticClass:"form-group col-md-6"},[a("validation-provider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.errors,s=e.classes;return[a("label",{attrs:{for:"category"}},[t._v("分類")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProduct.category,expression:"tempProduct.category"}],staticClass:"form-control",class:s,attrs:{id:"category",type:"text",placeholder:"請輸入分類"},domProps:{value:t.tempProduct.category},on:{input:function(e){e.target.composing||t.$set(t.tempProduct,"category",e.target.value)}}}),o[0]?a("span",{staticClass:"text-danger"},[t._v(t._s("分類"+o[0].slice(9,o[0].length)))]):t._e()]}}],null,!0)})],1)]),a("div",{staticClass:"form-row"},[a("div",{staticClass:"form-group col-md-6"},[a("validation-provider",{attrs:{rules:"required|numeric"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.errors,s=e.classes;return[a("label",{attrs:{for:"origin_price"}},[t._v("原價")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProduct.origin_price,expression:"tempProduct.origin_price"}],staticClass:"form-control",class:s,attrs:{id:"origin_price",type:"text",placeholder:"請輸入原價"},domProps:{value:t.tempProduct.origin_price},on:{input:function(e){e.target.composing||t.$set(t.tempProduct,"origin_price",e.target.value)}}}),o[0]?a("span",{staticClass:"text-danger"},[t._v(t._s("原價"+o[0].slice(13,o[0].length)))]):t._e()]}}],null,!0)})],1),a("div",{staticClass:"form-group col-md-6"},[a("validation-provider",{attrs:{rules:"required|numeric"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.errors,s=e.classes;return[a("label",{attrs:{for:"price"}},[t._v("價格")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProduct.price,expression:"tempProduct.price"}],staticClass:"form-control",class:s,attrs:{id:"price",type:"text",placeholder:"請輸入價格"},domProps:{value:t.tempProduct.price},on:{input:function(e){e.target.composing||t.$set(t.tempProduct,"price",e.target.value)}}}),o[0]?a("span",{staticClass:"text-danger"},[t._v(t._s("價格"+o[0].slice(6,o[0].length)))]):t._e()]}}],null,!0)})],1)]),a("div",{staticClass:"form-row"},[a("div",{staticClass:"form-group col-md-6"},[a("validation-provider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.errors,s=e.classes;return[a("label",{attrs:{for:"unit"}},[t._v("單位")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProduct.unit,expression:"tempProduct.unit"}],staticClass:"form-control",class:s,attrs:{id:"unit",type:"text",placeholder:"請輸入單位"},domProps:{value:t.tempProduct.unit},on:{input:function(e){e.target.composing||t.$set(t.tempProduct,"unit",e.target.value)}}}),o[0]?a("span",{staticClass:"text-danger"},[t._v(t._s("單位"+o[0].slice(5,o[0].length)))]):t._e()]}}],null,!0)})],1),a("div",{staticClass:"form-group col-md-6"},[a("label",[t._v("id")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProduct.id,expression:"tempProduct.id"}],staticClass:"form-control",attrs:{type:"text",placeholder:"自動產生",disabled:""},domProps:{value:t.tempProduct.id},on:{input:function(e){e.target.composing||t.$set(t.tempProduct,"id",e.target.value)}}})])])])]),a("div",{staticClass:"col-12"},[t._l(["description","content"],(function(e){return a("div",{key:e,staticClass:"form-group"},[a("validation-provider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(o){var s=o.errors;return[a("label",{attrs:{for:e}},[t._v(t._s(t.modalView.engToZh[e]))]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.tempProduct[e],expression:"tempProduct[item]"}],staticClass:"form-control",attrs:{id:e,type:"text",placeholder:"請輸入"+t.modalView.engToZh[e]},domProps:{value:t.tempProduct[e]},on:{input:function(a){a.target.composing||t.$set(t.tempProduct,e,a.target.value)}}}),s[0]?a("span",{staticClass:"text-danger"},[t._v(t._s(""+t.modalView.engToZh[e]+s[0].slice(s[0].length-3,s[0].length)))]):t._e()]}}],null,!0)})],1)})),a("div",{staticClass:"form-group"},[a("label",{staticClass:"form-check-label",attrs:{for:"enabled"}},[t._v("是否啟用")]),a("div",{staticClass:"mt-3"},[a("div",{staticClass:"form-check form-check-inline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProduct.enabled,expression:"tempProduct.enabled"}],staticClass:"form-check-input",attrs:{type:"radio"},domProps:{value:!0,checked:t._q(t.tempProduct.enabled,!0)},on:{change:function(e){return t.$set(t.tempProduct,"enabled",!0)}}}),a("label",{staticClass:"form-check-label"},[t._v("啟用")])]),a("div",{staticClass:"form-check form-check-inline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempProduct.enabled,expression:"tempProduct.enabled"}],staticClass:"form-check-input",attrs:{type:"radio"},domProps:{value:!1,checked:t._q(t.tempProduct.enabled,!1)},on:{change:function(e){return t.$set(t.tempProduct,"enabled",!1)}}}),a("label",{staticClass:"form-check-label"},[t._v("不啟用")])])])])],2)])]),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v(" 取消 ")]),a("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:o}},[t._v(" 確認 ")])])])])]}}])})],1)])},n=[],d={data:function(){return{tempProduct:{imageUrl:[],enabled:!1},modalView:{title:"建立新產品",engToZh:{title:"標題",id:"Id",category:"分類",unit:"單位",origin_price:"原價",price:"價格",description:"產品描述",content:"說明內容"}}}},props:{token:String,isNew:{type:Boolean,default:!0},user:{type:Object,default:function(){return{}}}},methods:{clearTempProduct:function(){this.tempProduct={imageUrl:[],enabled:!1},this.$refs.form.reset()},getProduct:function(t){var e=this;this.$refs.form.reset(),this.isNew||(this.modalView.title="編輯產品");var a="".concat("https://course-ec-api.hexschool.io/","api/").concat("765c633d-f16f-4821-90b7-1588004cb252","/admin/ec/product/").concat(t);this.$http.get(a).then((function(t){i()("#productModal").modal("show"),e.tempProduct=t.data.data})).catch((function(t){console.log(t)}))},updateProduct:function(t){t&&(this.tempProduct=t);var e="".concat("https://course-ec-api.hexschool.io/","api/").concat("765c633d-f16f-4821-90b7-1588004cb252","/admin/ec/product"),a="post";this.isNew||(e+="/".concat(this.tempProduct.id),a="patch"),this.axiosMethod(e,a)},axiosMethod:function(t,e){var a=this;this.$emit("loading"),this.$http.defaults.headers.common.Authorization="Bearer ".concat(this.token),this.$http[e](t,this.tempProduct).then((function(){i()("#productModal").modal("hide"),a.$bus.$emit("productUpdate",{product:a.tempProduct}),a.$emit("loading")})).catch((function(t){console.log(t)}))}}},l=d,u=(a("2a23"),a("2877")),p=Object(u["a"])(l,c,n,!1,null,null,null),m=p.exports,f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal fade",attrs:{id:"delProductModal"}},[a("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[a("div",{staticClass:"modal-content border-0"},[t._m(0),a("div",{staticClass:"modal-body"},[t._v(" 是否刪除 "),a("strong",[t._v(t._s(t.tempProduct.title))]),t._v(" 商品(刪除後將無法恢復)。 ")]),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v(" 取消 ")]),a("button",{staticClass:"btn btn-danger",attrs:{type:"button"},on:{click:t.delProduct}},[t._v(" 確認刪除 ")])])])])])},v=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[a("span",[t._v("刪除產品")])]),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal"}},[a("span",[t._v("×")])])])}],g={data:function(){return{}},props:{token:String,tempProduct:{type:Object,default:function(){return{imageUrl:[]}}},user:{type:Object,default:function(){return{}}}},methods:{delProduct:function(){var t=this,e="".concat("https://course-ec-api.hexschool.io/","api/").concat("765c633d-f16f-4821-90b7-1588004cb252","/admin/ec/product/").concat(this.tempProduct.id);this.$http.defaults.headers.common.Authorization="Bearer ".concat(this.token),this.$http.delete(e).then((function(){i()("#delProductModal").modal("hide"),t.$emit("update")}))}}},h=g,b=Object(u["a"])(h,f,v,!1,null,null,null),_=b.exports,P=a("e20e"),C={name:"Products",props:["token"],data:function(){return{products:[],pagination:{},isLoading:!1,tempProduct:{imageUrl:[],enabled:!1},isNew:!1}},components:{productModal:m,delProductModal:_,pagination:P["a"]},created:function(){var t=this;this.getProducts(),this.$bus.$on("productUpdate",(function(e){var a=t.products.map((function(t){return t.id}));a.includes(e.product.id)?t.products.forEach((function(a,o){a.id===e.product.id&&(t.products[o]=e.product)})):t.getProducts()}))},methods:{getProducts:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.isLoading=!0;var a="".concat("https://course-ec-api.hexschool.io/","api/").concat("765c633d-f16f-4821-90b7-1588004cb252","/admin/ec/products?page=").concat(e);this.$http.get(a).then((function(e){t.products=e.data.data,t.pagination=e.data.meta.pagination,t.isLoading=!1}))},openModal:function(t,e){switch(t){case"new":this.isNew=!0,this.$refs.productModel.clearTempProduct(),i()("#productModal").modal("show");break;case"edit":this.tempProduct=Object.assign({},e),this.isNew=!1,this.$refs.productModel.getProduct(this.tempProduct.id);break;case"delete":i()("#delProductModal").modal("show"),this.tempProduct=Object.assign({},e);break;default:break}},switchToActive:function(t){this.tempProduct=Object.assign({},t),this.tempProduct.enabled=!this.tempProduct.enabled,this.isNew=!1,this.$refs.productModel.updateProduct(this.tempProduct)},toolTip:function(){i()('[data-toggle="tooltip"]').tooltip()},loadingSwitch:function(){this.isLoading=!this.isLoading}}},w=C,x=(a("b6f1"),Object(u["a"])(w,o,s,!1,null,null,null));e["default"]=x.exports},8418:function(t,e,a){"use strict";var o=a("c04e"),s=a("9bf2"),r=a("5c6c");t.exports=function(t,e,a){var i=o(e);i in t?s.f(t,i,r(0,a)):t[i]=a}},"99af":function(t,e,a){"use strict";var o=a("23e7"),s=a("d039"),r=a("e8b5"),i=a("861d"),c=a("7b0b"),n=a("50c4"),d=a("8418"),l=a("65f0"),u=a("1dde"),p=a("b622"),m=a("2d00"),f=p("isConcatSpreadable"),v=9007199254740991,g="Maximum allowed index exceeded",h=m>=51||!s((function(){var t=[];return t[f]=!1,t.concat()[0]!==t})),b=u("concat"),_=function(t){if(!i(t))return!1;var e=t[f];return void 0!==e?!!e:r(t)},P=!h||!b;o({target:"Array",proto:!0,forced:P},{concat:function(t){var e,a,o,s,r,i=c(this),u=l(i,0),p=0;for(e=-1,o=arguments.length;e<o;e++)if(r=-1===e?i:arguments[e],_(r)){if(s=n(r.length),p+s>v)throw TypeError(g);for(a=0;a<s;a++,p++)a in r&&d(u,p,r[a])}else{if(p>=v)throw TypeError(g);d(u,p++,r)}return u.length=p,u}})},ab13:function(t,e,a){var o=a("b622"),s=o("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(a){try{return e[s]=!1,"/./"[t](e)}catch(o){}}return!1}},b44c:function(t,e,a){},b6f1:function(t,e,a){"use strict";var o=a("b44c"),s=a.n(o);s.a},caad:function(t,e,a){"use strict";var o=a("23e7"),s=a("4d64").includes,r=a("44d2"),i=a("ae40"),c=i("indexOf",{ACCESSORS:!0,1:0});o({target:"Array",proto:!0,forced:!c},{includes:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}}),r("includes")},d81d:function(t,e,a){"use strict";var o=a("23e7"),s=a("b727").map,r=a("1dde"),i=a("ae40"),c=r("map"),n=i("map");o({target:"Array",proto:!0,forced:!c||!n},{map:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}})},e20e:function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("nav",{attrs:{"aria-label":"Page navigation"}},[a("ul",{staticClass:"mt-5 pagination d-flex justify-content-center"},[a("li",{directives:[{name:"show",rawName:"v-show",value:1!==t.pages.current_page,expression:"pages.current_page !== 1"}],staticClass:"page-item"},[a("a",{staticClass:"page-link",attrs:{href:"#","aria-label":"Previous"},on:{click:function(e){return e.preventDefault(),t.emitPages(t.pages.current_page-1)}}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("«")])])]),t._l(t.pages.total_pages,(function(e,o){return a("li",{key:o,staticClass:"page-item",class:{active:e===t.pages.current_page,disabled:e===t.pages.current_page}},[a("a",{staticClass:"page-link",attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),t.emitPages(e)}}},[t._v(t._s(e))])])})),a("li",{directives:[{name:"show",rawName:"v-show",value:t.pages.current_page!==t.pages.total_pages,expression:"pages.current_page !== pages.total_pages"}],staticClass:"page-item"},[a("a",{staticClass:"page-link",attrs:{href:"#","aria-label":"Next"},on:{click:function(e){return e.preventDefault(),t.emitPages(t.pages.current_page+1)}}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("»")])])])],2)])])},s=[],r={data:function(){return{}},props:{pages:{type:Object,default:function(){return{}}}},methods:{emitPages:function(t){this.$emit("emit-pages",t)}}},i=r,c=(a("2fd4"),a("2877")),n=Object(c["a"])(i,o,s,!1,null,null,null);e["a"]=n.exports}}]);
//# sourceMappingURL=chunk-49503870.c981a4f7.js.map